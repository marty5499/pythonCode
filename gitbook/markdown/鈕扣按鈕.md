###### tags: `micropython`
鈕扣按鈕
=====

### RF433Mhz Button (315Mhz按鈕做法完全一樣，只是接收器不一樣)
鈕扣按鈕使用 CR2302 水銀電池，非常省電，可以使用一年左右，按按鈕後，按鈕會發出433Mhz頻率的唯一識別碼(12Bytes)，在這範例中，開發板接收到按鈕訊號後，會經由 MQTT 將按鈕識別碼發送到 wa5499/btn433 Topic，再透過積木程式接收對應顯示。

![](/uploads/upload_1a63f8467075f09536fbaf87ca40ee99.png)


315Mhz 範例
![](/uploads/upload_991ce97094081a8966d69c46f0d6a0ac.png)


### 開發板程式碼
```python=
#####################
try:
    import cmd
    machine.reset()
except:
    pass
#####################

# mac Address: 5c:cf:7f:81:0f:b5
from webduino import *
from machine import Pin,I2C
from utime import ticks_us, ticks_diff
from array import array
from RFBtn import RFBtn
import time,os

gnd = Pin(16,Pin.OUT)
gnd.on()

def beep(t=1):
    beep = Pin(14,Pin.OUT)
    for i in range(t):
        beep.off()
        time.sleep(0.015)
        beep.on()
        time.sleep(0.005)

# wemos
wemos = Board('RF433Mhz')
wemos.connect("KingKit_2.4G","webduino")

# btn
btn1 = "5556565a5556"
btn2 = "5566959a5556"
btn3 = "5559565a5556"
btn4 = "555aa5aa5556"

def runCode(code):
    if code == btn1 or code == btn2 or code == btn3 or code == btn4:
        beep(1)

publishTopic = "wa5499/btn433"
print("start...",wemos.deviceId)
wemos.onMsg(publishTopic,runCode)
pin5 = Pin(5,Pin.IN)

beep(1)
while True:
    data = RFBtn.listener(pin5,wemos.check)
    if(len(data)==12):
        wemos.mqtt.pub(publishTopic,data)
```

### 積木程式
![](/uploads/upload_585293b1a2e18450daee8943fc2b66d7.png =45%x)


