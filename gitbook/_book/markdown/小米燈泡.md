###### tags: `micropython`
小米燈泡
=====

### 使用第三方的類別庫 uyeelight，使用 Bulb 燈泡物件就可以輕鬆控制小米燈泡
![](/uploads/upload_a1bfd8703f1b1ac2441d985203f13012.png)


### 開發板程式碼
```python=
from webduino import *
from uyeelight import *
from machine import Pin,I2C
import time
# esp01
esp01 = Board('yeelight')
esp01.connect("webduino.io3","webduino")
# 接收燈泡控制命令
def ctrlBulb(cmd):
    print("cmd:",cmd)
    eval(cmd)

publishTopic = "wa5499/bulb"
print("start...",esp01.deviceId)

esp01.onMsg(publishTopic,ctrlBulb)
bulb = Bulb("192.168.0.95")
bulb.turn_on()
bulb.set_rgb(255,2,2,duration=1)
esp01.loop()
```

### 掃描燈泡 IP (esp8266掃不到 ><")

```python=
esp01 = Board(devId='0314')
while True:
    bulbs = Bulb.search(timeout=2)
    if len(bulbs)==0:
        print("not found")
    else:
        break;
    
ip = list(bulbs.keys())[0]
print("bulb ip:",ip)
bulb = Bulb(ip) 
bulb.turn_on()
bulb.set_rgb(255,255,255, effect=EFFECT.SUDDEN, duration=0.1)
```

